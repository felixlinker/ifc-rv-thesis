\NeedsTeXFormat{LaTeX2e}
\ProvidesClass{securem}

\LoadClass{article}
\RequirePackage{amsmath}
\RequirePackage{amsthm}
\RequirePackage{amssymb}
\RequirePackage{listings}
\RequirePackage{lstautogobble}

\newtheorem{theorem}{Theorem}
\theoremstyle{definition}
\newtheorem{definition}{Definition}
\theoremstyle{remark}
\newtheorem{remark}{Remark}
\newtheorem{example}{Example}

\lstdefinelanguage{PSL}{
    morekeywords=[1]{rule,assume,property,invariant},
    morekeywords=[2]{Called,Returned,Past,Rose,Fell,Stable,Changed},
    sensitive=false,
    morecomment=[l]{//},
    morestring=[b]",
}
\lstdefinelanguage{ASL}{
    morekeywords=[2]{if,then,elsif,else,case,of,when,otherwise,for,to,downto,while,do,repeat,until,return,assert,Consistent,enumeration,constant,is,array,bit,try,catch,throw,is,typeof},
    morekeywords=[3]{UNDEFINED,UNKNOWN,UNPREDICTABLE,CONSTRAINED_UNPREDICTABLE,SEE,IMPLEMENTATION_DEFINED,SUBARCHITECTURE_DEFINED,RAISE},
    morekeywords=[5]{QUOT,REM,DIV,MOD,AND,NOT,OR,EOR,IN},
    sensitive=true,
    morecomment=[l]{//},
    morecomment=[s]{/*}{*/},
    morestring=[b]",
}
\lstdefinelanguage{SMT2}{
    keywordsprefix={:},
    morekeywords=[3]{!,_,as,DECIMAL,exists,forall,let,NUMERAL,par,STRING},
    morekeywords=[4]{assert,check-sat,declare-sort, declare-fun,define-sort,define-fun,exit,get-assertions, get-assignment,get-info,get-option,get-proof,get-unsat-core,get-value,pop,push,set-logic,set-info,set-option,rule,query,declare-rel,declare-var},
    sensitive=false,
    morecomment=[l]{;},
    alsoletter={:},
    alsodigit={-},
}
\lstdefinelanguage{rv}{
    morekeywords=[1]{ADDI,SLTI,SLTIU,ANDI,ORI,XORI,SLLI,SRLI,SRAI,LUI,AUIPC,ADD,SLT,SLTU,AND,OR,XOR,SLL,SRL,SUB,SRA,JAL,JALR,BEQ,BNE,BLT,BLTU,BGE,BGEU,LW,LH,LHU,LB,LBU,SW,SH,SB,CSRRW,CSRRS,CSRRC,CSRRWI,CSRRSI,CSRCI,ECALL,EBREAK,MRET,URET,NOP},
    sensitive=false,
    morecomment=[l]{\#},
}
\lstdefinelanguage{minrv8}{
    morekeywords=[1]{LOAD,STORE,LOADI,ADD,SUB,AND,OR,MOV,SLL,SRA,SLT,ECALL,MRET,CSRRS,CSRRC,CLR,SAN,SPSEL,SPSET,PUSH,POP},
    sensitive=false,
    morecomment=[l]{\#},
}
\lstdefinelanguage{SMV}{
    morekeywords=[2]{
        boolean,word,unsigned word,signed word,real,integer,array,
        abs,max,min,xor,xnor,mod,word1,bool,toint,count,swconst,uwconst,signed,unsigned,sizeof,floor,extend,resize,union,in,next,init
    },
    morekeywords=[4]{
        VAR,IVAR,ASSIGN,TRANS,INIT,FROZENVAR,DEFINE,CONSTANTS,FUN,INVAR,FAIRNESS,JUSTICE,COMPASSION,MODULE,PRED,MIRROR,CTLSPEC,SPEC,INVARSPEC,LTLSPEC,PSLSPEC,
        AX,AG,AF,EX,EG,EF,E,A,X,G,F,U,V,Y,Z,H,O,S,T,EBF,ABF,EBG,ABG,MIN,MAX,abort,forall,inf,X!,W,always,never,next,next!,eventually!,until!,until,until!_,until_,before!,before,before!_,before_,next_a,next_a!,next_e,next_e!,next_event!,next_event,next_event_a!,next_event_a,next_event_e!,next_event_e,within!,within,within!_,within_,whilenot!,whilenote,whilenot!_,whilenot_
    },
    sensitive=true,
    morecomment=[l]{--},
    alsoletter={!,_},
}
\lstdefinelanguage{SecVerilogBL}{
    morekeywords=[4]{reg,input,output,wire,if,else,begin,end,assign},
    sensitive=false,
    morecomment=[l]{//},
}
\lstset{
    basicstyle=\ttfamily,
    keywordstyle={[1]\scshape},
    keywordstyle={[2]\itshape},
    keywordstyle={[3]\em},
    keywordstyle={[4]\bfseries},
    frame=shadowbox,
    framesep=5pt,
    rulesep=2.5pt,
    rulesepcolor=\color{gray},
    captionpos=b,
    abovecaptionskip=10pt,
    numbers=left,
    xleftmargin=2em,
    framexleftmargin=2em,
    aboveskip=10pt,
    autogobble,
    escapeinside={(*}{*)},
    breaklines=true,
    breakatwhitespace=true,
    postbreak=\mbox{\textcolor{gray}{$\hookrightarrow$}}
}
\renewcommand{\lstlistingname}{Snippet}
\renewcommand{\lstlistlistingname}{Snippets}
\newcommand{\asl}[1]{\lstinline[language=ASL,postbreak={}]{#1}}
\newcommand{\smt}[1]{\lstinline[language=SMT2,postbreak={}]{#1}}
\newcommand{\rv}[1]{\lstinline[language=rv,postbreak={}]{#1}}
\newcommand{\minrv}[1]{\lstinline[language=minrv8,postbreak={}]{#1}}
\newcommand{\smv}[1]{\lstinline[language=SMV,postbreak={}]{#1}}
