\NeedsTeXFormat{LaTeX2e}
\ProvidesClass{securem}

\LoadClass{article}
\RequirePackage{amsmath}
\RequirePackage{amsthm}
\RequirePackage{amssymb}
\RequirePackage{listings}

\newtheorem{theorem}{Theorem}
\theoremstyle{definition}
\newtheorem{definition}{Definition}
\theoremstyle{remark}
\newtheorem{remark}{Remark}
\newtheorem{example}{Example}

\lstdefinelanguage{PSL}{
    morekeywords=[1]{rule,assume,property,invariant},
    morekeywords=[2]{Called,Returned,Past,Rose,Fell,Stable,Changed},
    sensitive=false,
    morecomment=[l]{//},
    morestring=[b]",
}
\lstdefinelanguage{ASL}{
    morekeywords=[1]{if,then,elsif,else,case,of,when,otherwise,for,to,downto,while,do,repeat,until,return,assert,Consistent,enumeration,constant,is,array,bit,try,catch,throw,is,typeof},
    morekeywords=[2]{UNDEFINED,UNKNOWN,UNPREDICTABLE,CONSTRAINED_UNPREDICTABLE,SEE,IMPLEMENTATION_DEFINED,SUBARCHITECTURE_DEFINED,RAISE},
    morekeywords=[3]{QUOT,REM,DIV,MOD,AND,NOT,OR,EOR,IN},
    sensitive=true,
    morecomment=[l]{//},
    morecomment=[s]{/*}{*/},
    morestring=[b]",
}
\lstdefinelanguage{SMT2}{
    keywordsprefix={:},
    morekeywords=[1]{!,_,as,DECIMAL,exists,forall,let,NUMERAL,par,STRING},
    morekeywords=[2]{assert,check-sat,declare-sort, declare-fun,define-sort,define-fun,exit,get-assertions, get-assignment,get-info,get-option,get-proof,get-unsat-core,get-value,pop,push,set-logic,set-info,set-option,rule,query,declare-rel,declare-var},
    sensitive=false,
    morecomment=[l]{--},
    alsoletter={:},
    alsodigit={-},
}
\lstdefinelanguage{assembler}{
    morekeywords=[1]{ADDI,SLTI,SLTIU,ANDI,ORI,XORI,SLLI,SRLI,SRAI,LUI,AUIPC,ADD,SLT,SLTU,AND,OR,XOR,SLL,SRL,SUB,SRA,JAL,JALR,BEQ,BNE,BLT,BLTU,BGE,BGEU,LW,LH,LHU,LB,LBU,SW,SH,SB,CSRRW,CSRRS,CSRRC,CSRRWI,CSRRSI,CSRCI,ECALL,EBREAK,MRET,URET},
    sensitive=false,
    morecomment=[l]{\#},
}
\lstdefinestyle{PSLstyle}{
    language=PSL,
    basicstyle=\ttfamily,
    keywordstyle={[1]\scshape},
    keywordstyle={[2]\itshape},
    frame=shadowbox,
    framesep=5pt,
    rulesep=2.5pt,
    rulesepcolor=\color{gray},
    captionpos=b,
    abovecaptionskip=10pt,
    numbers=left,
    xleftmargin=2em,
    framexleftmargin=1.5em,
    escapechar=\#,
    aboveskip=10pt,
}
\lstdefinestyle{ASLstyle}{
    language=ASL,
    basicstyle=\ttfamily,
    keywordstyle={[1]\em},
    keywordstyle={[2]\itshape},
    frame=shadowbox,
    framesep=5pt,
    rulesep=2.5pt,
    rulesepcolor=\color{gray},
    captionpos=b,
    abovecaptionskip=10pt,
    numbers=left,
    xleftmargin=2em,
    framexleftmargin=1.5em,
    escapechar=\#,
    aboveskip=10pt,
}
\lstdefinestyle{SMT2style}{
    language=SMT2,
    basicstyle=\ttfamily,
    keywordstyle={[1]\em},
    keywordstyle={[2]\bfseries},
    frame=shadowbox,
    framesep=5pt,
    rulesep=2.5pt,
    rulesepcolor=\color{gray},
    captionpos=b,
    abovecaptionskip=10pt,
    numbers=left,
    xleftmargin=2em,
    framexleftmargin=1.5em,
    escapechar=\#,
    aboveskip=10pt,
}
\lstdefinestyle{assemblerstyle}{
    language=assembler,
    basicstyle=\ttfamily,
    keywordstyle={[1]\bfseries\scshape},
    frame=shadowbox,
    framesep=5pt,
    rulesep=2.5pt,
    rulesepcolor=\color{gray},
    captionpos=b,
    abovecaptionskip=10pt,
    numbers=left,
    xleftmargin=2em,
    framexleftmargin=1.5em,
    escapechar=~,
    aboveskip=10pt,
}
\renewcommand{\lstlistingname}{Snippet}
\renewcommand{\lstlistlistingname}{Snippets}
\lstnewenvironment{psl}[1][]
    {\lstset{style=PSLstyle,#1}}
    {}
\lstnewenvironment{asl}[1][]
    {\lstset{style=ASLstyle,#1}}
    {}
\lstnewenvironment{smt2}[1][]
    {\lstset{style=SMT2style,#1}}
    {}
\lstnewenvironment{assmblr}[1][]
    {\lstset{style=assemblerstyle,#1}}
    {}
\newcommand{\pslinline}[1]{\lstinline[style=PSLstyle]{#1}}
\newcommand{\aslinline}[1]{\lstinline[style=ASLstyle]{#1}}
\newcommand{\smt}[1]{\lstinline[style=SMT2style]{#1}}
\newcommand{\assmblrinline}[1]{\lstinline[style=assemblerstyle]{#1}}
